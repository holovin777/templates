{% load i18n %}
{% load image_tags %}

{% with all_images=product.get_all_images %}
    {# use length rather then count as the images get queried anyways #}

    {% if all_images|length > 1 %}

<div id="carousel" class="carousel slide" data-ride="carousel">
  <div class="carousel-inner">
	    {% for image in all_images %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
			    {% oscar_thumbnail image.original "440x400" crop="center" as thumb %}
                        <img src="{{ thumb.url }}" class="d-block w-100" alt="{{ product.get_title }}">
                    </div>
            {% endfor %}
 </div>
   <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
  </div>

                

    {% else %}

        {# Only one image to show #}
	<div id="carousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                    {% with image=product.primary_image %}
                        {% oscar_thumbnail image.original "440x400" upscale=False as thumb %}
                        <img src="{{ thumb.url }}" class="d-block w-100" alt="{{ product.get_title }}" />
                    {% endwith %}
                    </div>
                </div>
        </div>

    {% endif %}
{% endwith %}
